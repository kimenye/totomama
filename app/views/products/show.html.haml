.row
  .twelve.columns.ad
    .row
      .panel
        %h3 ADVERTISEMENT
.row
  .nine.columns
    .row.detail
      .three.columns
        = image_tag @product.photo.url
        = render :partial => "layouts/rating_readonly", :locals => { :product => @product }
      .nine.columns
        .twelve.columns
          %h5
            = @product.name
        .twelve.columns
          %dl.tabs.contained
            %dd.active
              %a{:href => "#productDescription"} Description
            %dd
              %a{:href => "#productReviews"} Reviews
            - if @product.type == "Shop"
              %dd#shopTab
                %a{:href => '#shopLocation'} Location
          %ul.tabs-content.contained
            %li#productDescriptionTab.active
              %p
                = @product.description
            %li#productReviewsTab
              .row.login
                .six.columns.centered
                  %a#loginLink{:href => "#"}
                  %p (Sign in to rate this product)
              .row.review.user-review.hide
                .two.columns
                  %h5 Rate
                .five.columns
                  .rating
                    %input#slug{:type=>"hidden", :value => @product.slug }
                    %input#star5{:type => 'radio', :name => 'product[rating]', :value => '5'}
                      %label{:for => 'star5', :title => '5'} 5 Stars
                    %input#star4{:type => 'radio', :name => 'product[rating]', :value => '4'}
                      %label{:for => 'star4', :title => '4'} 4 Stars
                    %input#star3{:type => 'radio', :name => 'product[rating]', :value => '3'}
                      %label{:for => 'star3', :title => '3'} 3 Stars
                    %input#star2{:type => 'radio', :name => 'product[rating]', :value => '2'}
                      %label{:for => 'star2', :title => '2'} 2 Stars
                    %input#star1{:type => 'radio', :name => 'product[rating]', :value => '1'}
                      %label{:for => 'star1', :title => '1'} 1 Stars
                .five.columns.social.color
                  %ul
                    %li
                      %a.pin
                    %li
                      %a.twt
                    %li
                      %a.fb
              .row.your-rating.user-review.hide
                .twelve.columns
                  .row
                    .twelve.columns
                      %h5 Add your review
                  .row
                    .eleven.columns
                      %textarea#my-rating{:rows => 5}
                    .one.columns
                  .row
                    .eight.columns
                    .four.columns
                      %a.button.radius#submitLink{}
                        Submit
                  .row
                    %br
              .row
                .ten.columns
                  %h5 User Reviews
                .two.columns
              .row
                .twelve.columns
                  - @product.ratings.each do |review|
                    .row.divider
                      .two.columns
                        = image_tag "http://graph.facebook.com/#{review.user_id}/picture"
                        %p
                          = review.username
                      .seven.columns
                        %p
                          = review.description
                      .three.columns.summary
                        = render :partial => "layouts/rating_readonly_review", :locals => { :rating => review }
            %li#shopLocationTab
              %p
                = @product.address
              .shop_location
                .map_container
                  #map
    - if !@cross_sell_products.empty?
      .row.header
        .twelve.columns
          %h5 You might also like
      .row
        .twelve.columns
          - @cross_sell_products.each_with_index do |product, i|
            = render :partial => "layouts/product", :locals => { :product => product, :last => i == @cross_sell_products.length - 1 }
  = render "layouts/sidebar"

- if @product.type == "Shop"
  :javascript

    $(document).ready(function() {
      var center = new google.maps.LatLng(#{@product.lat},#{@product.lon});
      var map = null;
      $("#shopTab a").click(function() {
        if (map == null) {
          $("#shopLocationTab").css({'display':'block'});
          $("#map").css({'width':'100%', 'height':'400px'});
          initialize();
        }
      });

      function initialize() {
        var mapOptions = {
            zoom: 15,
            center: center,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        map = new google.maps.Map(document.getElementById("map"), mapOptions);

        var marker = new google.maps.Marker({
            position: center,
            map: map
        });
      }
    });
